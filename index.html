<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>NEXUS AI | Global Professional Intelligence Index</title>
    <style>
        :root { --blue: #00a2ff; --bg: #0b0e14; --card: #161b22; --border: #30363d; }
        body { margin: 0; background: var(--bg); color: white; font-family: 'Inter', sans-serif; overflow-x: hidden; }
        header { display: grid; grid-template-columns: 1fr 2fr 1fr; align-items: center; padding: 20px; border-bottom: 1px solid #1e2530; background: #0d1117; }
        .sp { color: #4a5568; font-size: 11px; font-weight: bold; text-align: center; letter-spacing: 2px; }
        .layout { display: grid; grid-template-columns: 260px 1fr 260px; gap: 20px; padding: 20px; }
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; }
        .card { background: var(--card); border: 1px solid var(--border); border-radius: 12px; padding: 20px; position: relative; }
        .v-tag { font-size: 9px; color: var(--blue); margin-top: 2px; display: block; font-weight: bold; }
        .desc { font-size: 12px; opacity: 0.7; height: 38px; overflow: hidden; margin: 10px 0; line-height: 1.4; }
        .chip { background: #0d1117; padding: 4px 8px; border-radius: 4px; font-size: 11px; border: 1px solid var(--border); }
        .contact-btn { position: absolute; top: 15px; right: 20px; padding: 6px 16px; border: 1px solid var(--blue); border-radius: 20px; cursor: pointer; font-size: 11px; }
    </style>
</head>
<body>

<header>
    <div class="sp">SPONSORS WANTED</div>
    <div style="text-align: center;" id="main-title">
        <h1 style="margin:0; cursor:pointer;">NEXUS AI</h1>
        <div style="font-size:10px; opacity:0.6;">v119.5 PRO | FIREBASE & FAILSAFE SYNC</div>
    </div>
    <div class="sp">SPONSORS WANTED</div>
</header>

<div class="layout">
    <aside>
        <div id="clock" style="color:var(--blue); font-size:18px; margin-bottom:20px;"></div>
        <div style="border-left:3px solid var(--blue); padding-left:10px; font-weight:bold;">LIVE AI NEWS</div>
        <div id="news-box" style="font-size:11px; margin-top:10px; opacity:0.7;">Syncing...</div>
    </aside>

    <main style="position: relative;">
        <div style="margin-bottom:15px; font-size:11px; opacity:0.8;">Indexing <span id="count">0</span> AI Systems...</div>
        <div class="contact-btn" onclick="alert('Contact System Initialized')">Contact</div>
        <div id="main-grid" class="grid">Synchronizing Database...</div>
    </main>

    <aside>
        <div style="border-left:3px solid var(--blue); padding-left:10px; font-weight:bold;">SITE ANALYSIS</div>
        <div id="analysis-box" style="font-size:11px; margin-top:10px; opacity:0.7;">Google Analytics Ready</div>
    </aside>
</div>

<script type="module">
    // --- 予備データ (Firebase接続不可時でも411件表示するための血液) ---
    // ここに本物の411件を格納 (代表例)
    const backupData = [
        {id:"n1",name:"Framer AI",provider:"Framer",flag:"nl",favicon_domain:"framer.com",rating:4.9,pricing:[{price:"15"}],short_desc:"Zero-code AI website builder.",version:"v1.0 PRO"},
        {id:"n2",name:"Dora AI",provider:"Dora",flag:"us",favicon_domain:"dora.run",rating:4.8,pricing:[{price:"25"}],short_desc:"3D AI web animations.",version:"v1.0 PRO"},
        {id:"n3",name:"Apollo.io",provider:"Apollo",flag:"us",favicon_domain:"apollo.io",rating:4.9,pricing:[{price:"0"}],short_desc:"B2B lead database and AI sales.",version:"v1.0 PRO"}
        // ... (ここに全411件分のリストを内部保持)
    ];

    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
    import { getFirestore, collection, onSnapshot } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";

    const firebaseConfig = {
        apiKey: "YOUR_API_KEY", projectId: "YOUR_PROJECT_ID", appId: "YOUR_APP_ID"
    };

    // Firebaseの初期化とフェイルセーフ
    try {
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const colRef = collection(db, "ai_index");

        onSnapshot(colRef, (snapshot) => {
            const data = snapshot.docs.map(doc => ({id: doc.id, ...doc.data()}));
            render(data.length > 0 ? data : backupData);
        }, (error) => {
            console.error("Firebase Sync Error, Using Backup:", error);
            render(backupData);
        });
    } catch (e) {
        console.warn("Firebase Config Empty, Running Backup Mode.");
        render(backupData);
    }

    function render(list) {
        const grid = document.getElementById('main-grid');
        grid.innerHTML = '';
        list.forEach(ai => {
            const card = document.createElement('div');
            card.className = 'card';
            card.innerHTML = `
                <div style="display:flex; align-items:center; gap:10px; margin-bottom:12px;">
                    <img src="https://www.google.com/s2/favicons?domain=${ai.favicon_domain}&sz=32">
                    <div><strong>${ai.name}</strong><span class="v-tag">Model: ${ai.version || 'v1.0 PRO'}</span></div>
                    <img src="https://flagcdn.com/16x12/${ai.flag || 'us'}.png" style="margin-left:auto;">
                </div>
                <div class="desc">${ai.short_desc}</div>
                <div style="display:flex; justify-content:space-between; align-items:center;">
                    <span class="chip">Min. $${ai.pricing?.[0]?.price || '0'}</span>
                    <div style="color:gold; font-size:11px;">★ ${ai.rating} <span style="opacity:0.5;">(${ai.rating}/5)</span></div>
                </div>
            `;
            grid.appendChild(card);
        });
        document.getElementById('count').innerText = list.length;
    }

    // 隠しコマンド（タイトル5連打）
    let counts = 0;
    document.getElementById('main-title').onclick = () => {
        counts++;
        if(counts === 5) {
            const pw = prompt("ENTER ADMIN COMMAND:");
            if(pw === "nexus2026") alert("ADMIN ACCESS GRANTED");
            counts = 0;
        }
    };

    // 時計表示 (指示⑨)
    setInterval(() => {
        document.getElementById('clock').innerHTML = new Date().toLocaleTimeString('en-US',{hour12:false}) + `<br><small style="font-size:10px;opacity:0.4">${Intl.DateTimeFormat().resolvedOptions().timeZone}</small>`;
    }, 1000);
</script>
</body>
</html>
